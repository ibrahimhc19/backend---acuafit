import{R as j,f as g,j as t,B as I,r as p,e as M}from"./index-BKcJy05t.js";import{u as L,D as O,a as B,b as H,c as P,T as $,f as K,g as f,h as V,i as S,j as A,k as y,l as _}from"./dialog-DrtCgNVb.js";import{t as z,F as X,a as w,b as E,c as v,d as D,e as F,o as q,s as N}from"./form-Dvq5A19A.js";import{u as G}from"./index.esm-BE52ohF4.js";import{c as J,I as T}from"./createLucideIcon-C5bnr6OH.js";import"./index-CnEzmvKp.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],U=J("plus",Q),C=e=>{let r;const s=new Set,a=(l,b)=>{const m=typeof l=="function"?l(r):l;if(!Object.is(m,r)){const x=r;r=b??(typeof m!="object"||m===null)?m:Object.assign({},r,m),s.forEach(u=>u(r,x))}},n=()=>r,i={setState:a,getState:n,getInitialState:()=>d,subscribe:l=>(s.add(l),()=>s.delete(l))},d=r=e(a,n,i);return i},W=e=>e?C(e):C,Y=e=>e;function Z(e,r=Y){const s=j.useSyncExternalStore(e.subscribe,()=>r(e.getState()),()=>r(e.getInitialState()));return j.useDebugValue(s),s}const R=e=>{const r=W(e),s=a=>Z(r,a);return Object.assign(s,r),s},ee=e=>e?R(e):R,se=async()=>{var e,r,s,a;try{return(await g.get("/sedes")).data.data}catch(n){const o=n,c=((r=(e=o.response)==null?void 0:e.data)==null?void 0:r.message)??"Error inesperado",i=(a=(s=o.response)==null?void 0:s.data)==null?void 0:a.errors;throw{message:c,validationErrors:i}}},re=async e=>{var r,s,a,n;try{return(await g.post("/sede",e)).data}catch(o){const c=o,i=((s=(r=c.response)==null?void 0:r.data)==null?void 0:s.message)??"Error inesperado",d=(n=(a=c.response)==null?void 0:a.data)==null?void 0:n.errors;throw{message:i,validationErrors:d}}},te=async(e,r)=>{var s,a,n,o;try{return(await g.patch(`/sede/${e}`,r)).data}catch(c){const i=c,d=((a=(s=i.response)==null?void 0:s.data)==null?void 0:a.message)??"Error inesperado",l=(o=(n=i.response)==null?void 0:n.data)==null?void 0:o.errors;throw{message:d,validationErrors:l}}},ae=async e=>{var r,s,a,n;try{return(await g.delete(`/sede/${e}`)).data}catch(o){const c=o,i=((s=(r=c.response)==null?void 0:r.data)==null?void 0:s.message)??"Error inesperado",d=(n=(a=c.response)==null?void 0:a.data)==null?void 0:n.errors;throw{message:i,validationErrors:d}}},k=ee((e,r)=>({sedes:[],selectedSede:null,loading:!1,error:null,fetchSedes:async()=>{e({loading:!0,error:null});try{const s=await se();e({sedes:s})}catch(s){e({error:s.message||"Error al cargar sedes"})}finally{e({loading:!1})}},createSede:async s=>{await re(s),await r().fetchSedes()},updateSede:async(s,a)=>{await te(s,a),await r().fetchSedes()},deleteSede:async s=>{await ae(s),await r().fetchSedes()},selectSede:s=>{e({selectedSede:s})}})),oe=q({nombre:N().min(2,{message:"El nombre de la sede es obligatorio"}),direccion:N().min(2,{message:"La dirección de la sede es obligatorio"})});function ne({...e}){const r=G({resolver:z(oe),defaultValues:e||{nombre:"",direccion:"-"}});function s(a){console.log(a)}return t.jsx(X,{...r,children:t.jsxs("form",{onSubmit:r.handleSubmit(s),className:"space-y-8",children:[t.jsx(w,{control:r.control,name:"nombre",render:({field:a})=>t.jsxs(E,{children:[t.jsx(v,{children:"Nombre"}),t.jsx(D,{children:t.jsx(T,{...a})}),t.jsx(F,{})]})}),t.jsx(w,{control:r.control,name:"direccion",render:({field:a})=>t.jsxs(E,{children:[t.jsx(v,{children:"Dirección"}),t.jsx(D,{children:t.jsx(T,{...a})}),t.jsx(F,{})]})}),t.jsx(I,{type:"submit",children:"Submit"})]})})}function ce({columns:e,data:r}){var x;const s=L({data:r,columns:e,getCoreRowModel:_(),manualPagination:!0}),[a,n]=p.useState(!1),{selectedSede:o,selectSede:c,createSede:i,updateSede:d,deleteSede:l}=k(),[b,m]=p.useState({nombre:"",direccion:""});return p.useEffect(()=>{m(o?{nombre:o.nombre||"",direccion:o.direccion||""}:{nombre:"",direccion:""})},[o]),t.jsxs(t.Fragment,{children:[t.jsx("h1",{className:"scroll-m-20 flex-wrap text-3xl font-semibold text-primary mb-8",children:"Listado de Sedes"}),t.jsx(I,{variant:"outline",size:"sm",className:"hover:bg-primary hover:text-white flex justify-self-end mb-4 cursor-pointer",onClick:()=>{c(null),n(!0)},children:t.jsx(U,{})}),t.jsxs("div",{className:"rounded-md border",children:[a&&t.jsx(O,{open:a,onOpenChange:n,children:t.jsxs(B,{children:[t.jsx(H,{children:t.jsx(P,{children:o?"Editar Sede":"Agregar Sede"})}),t.jsx(ne,{...o})]})}),t.jsxs($,{children:[t.jsx(K,{children:s.getHeaderGroups().map(u=>t.jsx(f,{children:u.headers.map(h=>t.jsx(V,{children:h.isPlaceholder?null:S(h.column.columnDef.header,h.getContext())},h.id))},u.id))}),t.jsx(A,{className:"text-gray-600",children:(x=s.getRowModel().rows)!=null&&x.length?s.getRowModel().rows.map(u=>t.jsx(f,{onClick:()=>{c(u.original),n(!0)},className:"hover:text-muted hover:bg-primary cursor-pointer",children:u.getVisibleCells().map(h=>t.jsx(y,{className:"py-0.5",children:S(h.column.columnDef.cell,h.getContext())},h.id))},u.id)):t.jsx(f,{children:t.jsx(y,{colSpan:e.length,className:"h-8 text-center",children:"No hay resultados"})})})]})]})]})}const ie=[{accessorKey:"id",header:"#",cell:({row:e})=>e.index+1},{accessorKey:"nombre",header:"Nombre"},{accessorKey:"direccion",header:"Dirección"}];M.defaults.withCredentials=!0;M.defaults.withXSRFToken=!0;function pe(){const{sedes:e,fetchSedes:r}=k();return p.useEffect(()=>{r()},[]),t.jsx("div",{className:"container mx-auto px-6 py-4 lg:px-8 min-h-[68vh]",children:t.jsx(ce,{data:e,columns:ie})})}export{pe as default};
