import{r as g,j as e,B as h,t as d,d as F}from"./index-C4tmSXU-.js";import{u as p,A as w,a as R,b as z,c as L,d as k,e as H,f as P,g as B,h as I}from"./alert-dialog-rC-hXEpy.js";import{d as K,e as M,u as V,D as G,a as X,b as q,c as J,m as Q,T as U,f as W,g as f,h as Y,i as b,j as Z,k as D,l as _}from"./dialog-DJuDSwhf.js";import{t as $,F as O,a as y,b as C,c as S,d as T,e as v,o as ee,s as A}from"./form-BlLoRA9W.js";import{u as ae}from"./index.esm-DTiEesBQ.js";import{I as N}from"./createLucideIcon-B7HhsFcP.js";import{T as re,a as se,b as le}from"./tooltip-C4nGVJ0s.js";import{P as ie}from"./plus-BvFwkRlC.js";import"./react-CUPexu54.js";import"./index-CNyQeywB.js";const oe=ee({nombre:A().min(2,{message:"El nombre de la sede es obligatorio"}),direccion:A()});function te({setIsModalOpen:r}){const{selectSede:o,selectedSede:a,createSede:u,updateSede:t,deleteSede:x}=p(),[n,m]=g.useState(!1),[c,l]=g.useState(!1),s=ae({resolver:$(oe),defaultValues:a||{nombre:"",direccion:"-"}}),E=async i=>{if(m(!0),a!=null&&a.id)try{await t(a.id,i),d.success("La sede fue actualizada correctamente."),o(null),r(!1)}catch(j){d.error("No se pudo actualizar la sede. Intenta de nuevo."),console.error("Error al actualizar",j)}finally{m(!1),r(!1)}else try{await u(i),d.success("La sede fue registrada correctamente."),o(null),r(!1)}catch(j){d.error("No se pudo registrar la sede. Intenta de nuevo."),console.error("Error al registrar",j)}finally{m(!1),r(!1)}};return e.jsx(O,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(E),className:"space-y-8",children:[e.jsx(y,{control:s.control,name:"nombre",render:({field:i})=>e.jsxs(C,{children:[e.jsx(S,{children:"Nombre"}),e.jsx(T,{children:e.jsx(N,{...i})}),e.jsx(v,{})]})}),e.jsx(y,{control:s.control,name:"direccion",render:({field:i})=>e.jsxs(C,{children:[e.jsx(S,{children:"Dirección"}),e.jsx(T,{children:e.jsx(N,{...i})}),e.jsx(v,{})]})}),e.jsxs(K,{children:[e.jsx(M,{asChild:!0,children:e.jsx(h,{variant:"outline",children:"Cancelar"})}),e.jsx(h,{type:"submit",disabled:n,children:n?"Guardando":a?"Actualizar":"Agregar"}),e.jsxs(w,{children:[e.jsx(R,{asChild:!0,children:a&&e.jsx(h,{variant:"destructive",disabled:c?!0:!a,children:c?"Eliminando":"Eliminar"})}),e.jsxs(z,{children:[e.jsxs(L,{children:[e.jsx(k,{children:"¿Estás seguro?"}),e.jsx(H,{children:"Esta acción eliminará permanentemente la sede seleccionada."})]}),e.jsxs(P,{children:[e.jsx(B,{children:"Cancelar"}),e.jsx(I,{disabled:n,onClick:async()=>{if(a!=null&&a.id){l(!0);try{await x(a.id),d.success("La sede fue eliminada correctamente."),o(null),r(!1)}catch(i){d.error("No se pudo eliminar la sede. Intenta de nuevo."),console.error("Error al eliminar",i)}finally{l(!1),r(!1)}}},children:c?"Eliminando":"Confirmar"})]})]})]})]})]})})}function ne({columns:r,data:o}){var c;const a=V({data:o,columns:r,getCoreRowModel:_(),manualPagination:!0}),[u,t]=g.useState(!1),{selectedSede:x,selectSede:n}=p(),m={setIsModalOpen:t};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"scroll-m-20 flex-wrap text-3xl font-semibold text-primary mb-8",children:"Listado de Sedes"}),e.jsxs(re,{children:[e.jsx(se,{asChild:!0,children:e.jsx(h,{variant:"outline",size:"sm",className:"hover:bg-primary hover:text-white flex justify-self-end mb-4 cursor-pointer",onClick:()=>{n(null),t(!0)},children:e.jsx(ie,{})})}),e.jsx(le,{children:e.jsx("p",{children:"Crea un nuevo registro"})})]}),e.jsxs("div",{className:"rounded-md border",children:[u&&e.jsx(G,{open:u,onOpenChange:t,children:e.jsxs(X,{children:[e.jsxs(q,{children:[e.jsx(J,{children:x?"Editar Sede":"Agregar Sede"}),e.jsx(Q,{children:x?"Modifica los datos de la sede y haz clic en 'Actualizar' para guardar los cambios.":"Completa la información para registrar una nueva sede en el sistema."})]}),e.jsx(te,{...m})]})}),e.jsxs(U,{children:[e.jsx(W,{children:a.getHeaderGroups().map(l=>e.jsx(f,{children:l.headers.map(s=>e.jsx(Y,{children:s.isPlaceholder?null:b(s.column.columnDef.header,s.getContext())},s.id))},l.id))}),e.jsx(Z,{className:"text-gray-600",children:(c=a.getRowModel().rows)!=null&&c.length?a.getRowModel().rows.map(l=>e.jsx(f,{onClick:()=>{n(l.original),t(!0)},className:"hover:text-muted hover:bg-primary cursor-pointer",children:l.getVisibleCells().map(s=>e.jsx(D,{className:"py-0.5",children:b(s.column.columnDef.cell,s.getContext())},s.id))},l.id)):e.jsx(f,{children:e.jsx(D,{colSpan:r.length,className:"h-8 text-center",children:"No hay resultados"})})})]})]})]})}const ce=[{accessorKey:"id",header:"#",cell:({row:r})=>r.index+1},{accessorKey:"nombre",header:"Nombre"},{accessorKey:"direccion",header:"Dirección"}];F.defaults.withCredentials=!0;F.defaults.withXSRFToken=!0;function De(){const{sedes:r,fetchSedes:o}=p();return g.useEffect(()=>{o()},[]),e.jsx("div",{className:"container mx-auto px-6 py-4 lg:px-8 min-h-[68vh]",children:e.jsx(ne,{data:r,columns:ce})})}export{De as default};
