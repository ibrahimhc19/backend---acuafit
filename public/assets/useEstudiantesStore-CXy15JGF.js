import{l}from"./index-Bso-p6jD.js";import{c as h}from"./react-ZjbKzo2G.js";const w=async(e,t,a)=>{var r,s,n,o;try{if(t&&(t==null?void 0:t.trim())!=="")return(await l.get(`client/buscar?q=${encodeURIComponent(t)}&per_page=${a}${e?`&page=${e}`:""}`)).data;{const i=new URLSearchParams;return a&&i.append("per_page",a.toString()),e&&i.append("page",e),(await l.get(`client/estudiantes?${i.toString()}`)).data}}catch(i){const c=i,p=((s=(r=c.response)==null?void 0:r.data)==null?void 0:s.message)??"Error inesperado",d=(o=(n=c.response)==null?void 0:n.data)==null?void 0:o.errors;throw{message:p,validationErrors:d}}},x=async e=>{var t,a,r,s;try{return(await l.post("client/estudiante",e)).data}catch(n){const o=n,i=((a=(t=o.response)==null?void 0:t.data)==null?void 0:a.message)??"Error inesperado",c=(s=(r=o.response)==null?void 0:r.data)==null?void 0:s.errors;throw{message:i,validationErrors:c}}},y=async(e,t)=>{var a,r,s,n;try{return(await l.patch(`client/estudiante/${e}`,t)).data}catch(o){const i=o,c=((r=(a=i.response)==null?void 0:a.data)==null?void 0:r.message)??"Error inesperado",p=(n=(s=i.response)==null?void 0:s.data)==null?void 0:n.errors;throw{message:c,validationErrors:p}}},v=async e=>{var t,a,r,s;try{return(await l.delete(`client/estudiante/${e}`)).data}catch(n){const o=n,i=((a=(t=o.response)==null?void 0:t.data)==null?void 0:a.message)??"Error inesperado",c=(s=(r=o.response)==null?void 0:r.data)==null?void 0:s.errors;throw{message:i,validationErrors:c}}},b=h((e,t)=>({estudiantes:[],selectedEstudiante:null,loading:!1,pagination:"",per_page:10,query:void 0,error:null,pageLinks:{first_page_url:"",last_page_url:"",next_page_url:null,prev_page_url:null},pageNumRefs:{current_page:1,last_page:1,per_page:10,from:0,to:0,total:0,next_page:null},fetchEstudiantes:async(a,r,s)=>{e({loading:!0,error:null});try{const n=await w(a,r,s),{current_page:o,last_page:i,per_page:c,from:p,to:d,total:g,next_page:u,first_page_url:_,last_page_url:E,next_page_url:m,prev_page_url:f}=n;e({pageNumRefs:{current_page:o,last_page:i,per_page:c,from:p,to:d,total:g,next_page:u}}),e({pageLinks:{first_page_url:_,last_page_url:E,next_page_url:m,prev_page_url:f}}),e({estudiantes:n.data})}catch(n){e({error:n.message||"Error al cargar estudiantes"})}finally{e({loading:!1})}},handlePageChange:async a=>{const r=t().pageLinks;function s(n){const o=n.split("=");return o.length>=4?o[3]:o[1]}switch(a){case"first":e({pagination:s(r.first_page_url)});break;case"previous":e({pagination:s(r.prev_page_url??"")});break;case"next":e({pagination:s(r.next_page_url??"")}),console.log(t().pagination);break;case"last":e({pagination:s(r.last_page_url??"")});break}},setQuery:a=>{e({query:a})},setPerPage:a=>{e({per_page:a})},createEstudiante:async a=>{await x(a),await t().fetchEstudiantes()},updateEstudiante:async(a,r)=>{await y(a,r),await t().fetchEstudiantes()},deleteEstudiante:async a=>{await v(a),await t().fetchEstudiantes()},selectEstudiante:a=>{e({selectedEstudiante:a})}}));export{b as u};
