import{r as g,j as e,B as h,t as d,i as F}from"./index-BpwpecHK.js";import{u as p,t as w,F as R,a as b,b as D,c as y,d as C,e as S,o as z,s as T}from"./form-CMpMfg_o.js";import{d as L,e as k,u as H,P,D as B,a as I,b as K,c as M,m as V,T as G,f as X,g as f,h as q,i as v,j as J,k as A,l as Q}from"./dialog-BLvYGc_k.js";import{u as U}from"./index.esm-CU8W_-v0.js";import{I as N}from"./input-DUNZ_nzV.js";import{A as W,a as Y,b as Z,c as _,d as $,e as O,f as ee,g as ae,h as se}from"./alert-dialog-BSIQRhZM.js";import{T as re,a as le,b as ie}from"./tooltip-BkPc0lcC.js";import"./react-CW3DGQnN.js";import"./createLucideIcon-DCIsN9cM.js";import"./index-Bvy_5XQ7.js";const te=z({nombre:T().min(2,{message:"El nombre de la sede es obligatorio"}),direccion:T()});function oe({setIsModalOpen:s}){const{selectSede:t,selectedSede:a,createSede:u,updateSede:o,deleteSede:x}=p(),[n,m]=g.useState(!1),[c,l]=g.useState(!1),r=U({resolver:w(te),defaultValues:a||{nombre:"",direccion:""}}),E=async i=>{if(m(!0),a!=null&&a.id)try{await o(a.id,i),d.success("La sede fue actualizada correctamente."),t(null),s(!1)}catch(j){d.error("No se pudo actualizar la sede. Intenta de nuevo."),console.error("Error al actualizar",j)}finally{m(!1),s(!1)}else try{await u(i),d.success("La sede fue registrada correctamente."),t(null),s(!1)}catch(j){d.error("No se pudo registrar la sede. Intenta de nuevo."),console.error("Error al registrar",j)}finally{m(!1),s(!1)}};return e.jsx(R,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(E),className:"space-y-8",children:[e.jsx(b,{control:r.control,name:"nombre",render:({field:i})=>e.jsxs(D,{children:[e.jsx(y,{children:"Nombre"}),e.jsx(C,{children:e.jsx(N,{...i})}),e.jsx(S,{})]})}),e.jsx(b,{control:r.control,name:"direccion",render:({field:i})=>e.jsxs(D,{children:[e.jsx(y,{children:"Dirección"}),e.jsx(C,{children:e.jsx(N,{...i})}),e.jsx(S,{})]})}),e.jsxs(L,{children:[e.jsx(k,{asChild:!0,children:e.jsx(h,{variant:"outline",children:"Cancelar"})}),e.jsx(h,{type:"submit",disabled:n,children:n?"Guardando":a?"Actualizar":"Agregar"}),e.jsxs(W,{children:[e.jsx(Y,{asChild:!0,children:a&&e.jsx(h,{variant:"destructive",disabled:c?!0:!a,children:c?"Eliminando":"Eliminar"})}),e.jsxs(Z,{children:[e.jsxs(_,{children:[e.jsx($,{children:"¿Estás seguro?"}),e.jsx(O,{children:"Esta acción eliminará permanentemente la sede seleccionada."})]}),e.jsxs(ee,{children:[e.jsx(ae,{children:"Cancelar"}),e.jsx(se,{disabled:n,onClick:async()=>{if(a!=null&&a.id){l(!0);try{await x(a.id),d.success("La sede fue eliminada correctamente."),t(null),s(!1)}catch(i){d.error("No se pudo eliminar la sede. Intenta de nuevo."),console.error("Error al eliminar",i)}finally{l(!1),s(!1)}}},children:c?"Eliminando":"Confirmar"})]})]})]})]})]})})}function ne({columns:s,data:t}){var c;const a=H({data:t,columns:s,getCoreRowModel:Q(),manualPagination:!0}),[u,o]=g.useState(!1),{selectedSede:x,selectSede:n}=p(),m={setIsModalOpen:o};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"scroll-m-20 flex-wrap text-3xl font-semibold text-primary mb-8",children:"Listado de Sedes"}),e.jsxs(re,{children:[e.jsx(le,{asChild:!0,children:e.jsx(h,{variant:"outline",size:"sm",className:"hover:bg-primary hover:text-white flex justify-self-end mb-4 cursor-pointer",onClick:()=>{n(null),o(!0)},children:e.jsx(P,{})})}),e.jsx(ie,{children:e.jsx("p",{children:"Crea un nuevo registro"})})]}),e.jsxs("div",{className:"rounded-md border",children:[u&&e.jsx(B,{open:u,onOpenChange:o,children:e.jsxs(I,{children:[e.jsxs(K,{children:[e.jsx(M,{children:x?"Editar Sede":"Agregar Sede"}),e.jsx(V,{children:x?"Modifica los datos de la sede y haz clic en 'Actualizar' para guardar los cambios.":"Completa la información para registrar una nueva sede en el sistema."})]}),e.jsx(oe,{...m})]})}),e.jsxs(G,{children:[e.jsx(X,{children:a.getHeaderGroups().map(l=>e.jsx(f,{children:l.headers.map(r=>e.jsx(q,{children:r.isPlaceholder?null:v(r.column.columnDef.header,r.getContext())},r.id))},l.id))}),e.jsx(J,{className:"text-gray-600",children:(c=a.getRowModel().rows)!=null&&c.length?a.getRowModel().rows.map(l=>e.jsx(f,{onClick:()=>{n(l.original),o(!0)},className:"hover:text-muted hover:bg-primary cursor-pointer",children:l.getVisibleCells().map(r=>e.jsx(A,{className:"py-0.5",children:v(r.column.columnDef.cell,r.getContext())},r.id))},l.id)):e.jsx(f,{children:e.jsx(A,{colSpan:s.length,className:"h-8 text-center",children:"No hay resultados"})})})]})]})]})}const ce=[{accessorKey:"id",header:"#",cell:({row:s})=>s.index+1},{accessorKey:"nombre",header:"Nombre"},{accessorKey:"direccion",header:"Dirección"}];F.defaults.withCredentials=!0;F.defaults.withXSRFToken=!0;function De(){const{sedes:s,fetchSedes:t}=p();return g.useEffect(()=>{t()},[]),e.jsx("div",{className:"container mx-auto px-6 py-4 lg:px-8 min-h-[68vh]",children:e.jsx(ne,{data:s,columns:ce})})}export{De as default};
