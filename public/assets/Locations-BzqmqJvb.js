import{j as e,B as u,t as c,r as A,h as N}from"./index-6cm5RRqV.js";import{u as j,A as T,a as F,b as w,c as E,d as R,e as z,f as L,g as M,h as k,P as H}from"./alert-dialog-ZEWMxfEE.js";import{d as I,e as P,u as B,D as K,a as V,b as O,c as X,m as q,T as G,f as J,g as h,h as Q,i as g,j as U,k as p,l as W}from"./dialog-dzjnMq20.js";import{t as Y,F as Z,a as f,b,c as D,d as y,e as C,o as _,s as S}from"./form-wBz8qGkD.js";import{u as $}from"./index.esm-CuZJDtpc.js";import{I as v}from"./createLucideIcon-o3Uymo5R.js";import"./index-CQWa2sZY.js";const ee=_({nombre:S().min(2,{message:"El nombre de la sede es obligatorio"}),direccion:S()});function ae({setIsModalOpen:s}){const{selectSede:t,selectedSede:a,createSede:d,updateSede:n,deleteSede:m}=j(),i=$({resolver:Y(ee),defaultValues:a||{nombre:"",direccion:"-"}}),x=async r=>{if(a!=null&&a.id)try{await n(a.id,r),c.success("La sede fue actualizada correctamente."),t(null),s(!1)}catch(o){c.error("No se pudo actualizar la sede. Intenta de nuevo."),console.error("Error al actualizar",o)}else try{await d(r),c.success("La sede fue registrada correctamente."),t(null),s(!1)}catch(o){c.error("No se pudo registrar la sede. Intenta de nuevo."),console.error("Error al registrar",o)}};return e.jsx(Z,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(x),className:"space-y-8",children:[e.jsx(f,{control:i.control,name:"nombre",render:({field:r})=>e.jsxs(b,{children:[e.jsx(D,{children:"Nombre"}),e.jsx(y,{children:e.jsx(v,{...r})}),e.jsx(C,{})]})}),e.jsx(f,{control:i.control,name:"direccion",render:({field:r})=>e.jsxs(b,{children:[e.jsx(D,{children:"Dirección"}),e.jsx(y,{children:e.jsx(v,{...r})}),e.jsx(C,{})]})}),e.jsxs(I,{children:[e.jsx(P,{asChild:!0,children:e.jsx(u,{variant:"outline",children:"Cancelar"})}),e.jsx(u,{type:"submit",children:a?"Actualizar":"Agregar"}),e.jsxs(T,{children:[e.jsx(F,{asChild:!0,children:e.jsx(u,{variant:"destructive",disabled:!a,children:"Eliminar"})}),e.jsxs(w,{children:[e.jsxs(E,{children:[e.jsx(R,{children:"¿Estás seguro?"}),e.jsx(z,{children:"Esta acción eliminará permanentemente la sede seleccionada."})]}),e.jsxs(L,{children:[e.jsx(M,{children:"Cancelar"}),e.jsx(k,{onClick:async()=>{if(a!=null&&a.id)try{await m(a.id),c.success("La sede fue eliminada correctamente."),t(null),s(!1)}catch(r){c.error("No se pudo eliminar la sede. Intenta de nuevo."),console.error("Error al eliminar",r)}},children:"Confirmar"})]})]})]})]})]})})}function re({columns:s,data:t}){var r;const a=B({data:t,columns:s,getCoreRowModel:W(),manualPagination:!0}),[d,n]=A.useState(!1),{selectedSede:m,selectSede:i}=j(),x={setIsModalOpen:n};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"scroll-m-20 flex-wrap text-3xl font-semibold text-primary mb-8",children:"Listado de Sedes"}),e.jsx(u,{variant:"outline",size:"sm",className:"hover:bg-primary hover:text-white flex justify-self-end mb-4 cursor-pointer",onClick:()=>{i(null),n(!0)},children:e.jsx(H,{})}),e.jsxs("div",{className:"rounded-md border",children:[d&&e.jsx(K,{open:d,onOpenChange:n,children:e.jsxs(V,{children:[e.jsxs(O,{children:[e.jsx(X,{children:m?"Editar Sede":"Agregar Sede"}),e.jsx(q,{children:m?"Modifica los datos de la sede y haz clic en 'Actualizar' para guardar los cambios.":"Completa la información para registrar una nueva sede en el sistema."})]}),e.jsx(ae,{...x})]})}),e.jsxs(G,{children:[e.jsx(J,{children:a.getHeaderGroups().map(o=>e.jsx(h,{children:o.headers.map(l=>e.jsx(Q,{children:l.isPlaceholder?null:g(l.column.columnDef.header,l.getContext())},l.id))},o.id))}),e.jsx(U,{className:"text-gray-600",children:(r=a.getRowModel().rows)!=null&&r.length?a.getRowModel().rows.map(o=>e.jsx(h,{onClick:()=>{i(o.original),n(!0)},className:"hover:text-muted hover:bg-primary cursor-pointer",children:o.getVisibleCells().map(l=>e.jsx(p,{className:"py-0.5",children:g(l.column.columnDef.cell,l.getContext())},l.id))},o.id)):e.jsx(h,{children:e.jsx(p,{colSpan:s.length,className:"h-8 text-center",children:"No hay resultados"})})})]})]})]})}const se=[{accessorKey:"id",header:"#",cell:({row:s})=>s.index+1},{accessorKey:"nombre",header:"Nombre"},{accessorKey:"direccion",header:"Dirección"}];N.defaults.withCredentials=!0;N.defaults.withXSRFToken=!0;function me(){const{sedes:s,fetchSedes:t}=j();return A.useEffect(()=>{t()},[]),e.jsx("div",{className:"container mx-auto px-6 py-4 lg:px-8 min-h-[68vh]",children:e.jsx(re,{data:s,columns:se})})}export{me as default};
